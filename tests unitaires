using System;
using System.Collections.Generic;
using Xunit;
using GraphEtudiantSimple;

namespace TestProject1
{
    public class GrapheTests
    {
        [Fact]
        public void AjouterSommet_AjouteUnSommet()
        {
            var graphe = new Graphe();
            graphe.AjouterSommet("1");
            Assert.True(graphe.sommets.ContainsKey("1"));
        }

        [Fact]
        public void AjouterConnexion_AjouteUneConnexion()
        {
            var graphe = new Graphe();
            graphe.AjouterSommet("1");
            graphe.AjouterSommet("2");
            graphe.AjouterConnexion("1", "2");

            Assert.Contains(graphe.sommets["1"].connexions, c => c.cible.nom == "2");
            Assert.Contains(graphe.sommets["2"].connexions, c => c.cible.nom == "1");
        }

        [Fact]
        public void AjouterConnexion_ErreurSiSommetInexistant()
        {
            var graphe = new Graphe();
            graphe.AjouterSommet("1");

            var ex = Record.Exception(() => graphe.AjouterConnexion("1", "3"));
            Assert.Null(ex); // Ne doit pas lever d'exception
        }

        [Fact]
        public void AfficherListe_AfficheCorrectement()
        {
            var graphe = new Graphe();
            graphe.AjouterSommet("1");
            graphe.AjouterSommet("2");
            graphe.AjouterSommet("3");
            graphe.AjouterConnexion("1", "2");
            graphe.AjouterConnexion("2", "3");

            var output = new System.IO.StringWriter();
            Console.SetOut(output);
            graphe.AfficherListe();

            var expectedOutput = "Liste d'adjacence :\n1 -> 2 \n2 -> 1 3 \n3 -> 2 \n";
            var actualOutput = output.ToString().Replace("\r\n", "\n");
            Assert.Equal(expectedOutput, actualOutput);
        }


        [Fact]
        public void ParcourLargeur_ParcourtCorrectement()
        {
            var graphe = new Graphe();
            graphe.AjouterSommet("1");
            graphe.AjouterSommet("2");
            graphe.AjouterSommet("3");
            graphe.AjouterConnexion("1", "2");
            graphe.AjouterConnexion("2", "3");

            var output = new System.IO.StringWriter();
            Console.SetOut(output);
            graphe.ParcourLargeur("1");

            var expectedOutput = "Parcours en largeur :\n1 2 3 \n";
            var actualOutput = output.ToString().Replace("\r\n", "\n");
            Assert.Equal(expectedOutput, actualOutput);
        }

        [Fact]
        public void ParcourProfondeur_ParcourtCorrectement()
        {
            var graphe = new Graphe();
            graphe.AjouterSommet("1");
            graphe.AjouterSommet("2");
            graphe.AjouterSommet("3");
            graphe.AjouterConnexion("1", "2");
            graphe.AjouterConnexion("2", "3");

            var output = new System.IO.StringWriter();
            Console.SetOut(output);
            graphe.ParcourProfondeur("1");

            var expectedOutput = "Parcours en profondeur :\n1 2 3 \n";
            var actualOutput = output.ToString().Replace("\r\n", "\n");
            Assert.Equal(expectedOutput, actualOutput);
        }
    }
}
